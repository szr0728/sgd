<!DOCTYPE html>
<html>
<head>
    <meta content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"
          name="viewport">
    <meta content="IE=edge,chrome=1;charset=utf-8" http-equiv="X-UA-Compatible">
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="webkit" name="renderer"/>
    <meta content="index, follow" name="robots"/>
    <link href="qtimages/css/font-awesome.css" media="screen" rel="stylesheet" type="text/css"/>
    <link href="qtimages/css/bootstrap.css" media="screen" rel="stylesheet" type="text/css"/>
    <link href="qtimages/css/owl.carousel.css" media="screen" rel="stylesheet" type="text/css"/>
    <link href="qtimages/css/magnific-popup.css" media="screen" rel="stylesheet" type="text/css"/>
    <link href="qtimages/css/animate.css" media="screen" rel="stylesheet" type="text/css"/>
    <link href="qtimages/css/settings.css" media="screen" rel="stylesheet" type="text/css"/>
    <link href="qtimages/css/style-red.css" media="screen" rel="stylesheet" type="text/css"/>
    <link href="qtimages/css/tk.css" media="screen" rel="stylesheet" type="text/css"/>
    <script src="qtimages/js/jquery.min.js" type="text/javascript"></script>
    <script src="qtimages/js/jquery.migrate.js" type="text/javascript"></script>
    <script src="qtimages/js/bootstrap.js" type="text/javascript"></script>
    <script src="qtimages/js/owl.carousel.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(function () {
            $("#navigation #nav_0 .menu1").addClass("active");
        });
    </script>
    <link href="./qtimages/sl_common_form.css" rel="stylesheet">
    <title>用户信息</title>
</head>
<body>
<div id="wrapper">
    <div id="container">
        <script src="qttop.js"></script>
        <script src="bht.js"></script>
        <div id="content">

            <div class="section-content team-section2 no-padd" id="index-news">
                <div class="title-section title2">
                    <div class="container triggerAnimation animated" data-animate="bounceIn">
                        <h1>用户信息</h1>
                    </div>
                </div>
                <div class="team-box">
                    <div class="container">
                        <div class="row">
                            <div class="content-form">

                                <div style="padding: 0 20px">


                                    <!-- 表格主体-->
                                    <div style="margin-top: 10px">
                                        <div style="border: 1px solid #ff6b31;">
                                            <div style="padding: 5px; border-bottom: 1px solid #ff6b31; color: white; background-color: #ff6b31;">
                                                用户信息
                                            </div>
                                            <div style="border: 1px solid #ccc; padding: 10px">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <form class="form-horizontal">
                                                            <input type="hidden" v-model="entity.id">
                                                            <table class="table table-striped table-bordered table-hover">
                                                                <tr>
                                                                    <td>用户名</td>
                                                                    <td><input class="form-control" id="yonghuming"
                                                                               placeholder="请输入用户名"
                                                                               style="width: 160px"
                                                                               type="text"
                                                                               v-model="entity.yonghuming"></td>
                                                                </tr>
                                                                <tr>
                                                                    <td>密码</td>
                                                                    <td><input class="form-control" id="mima"
                                                                               placeholder="请输入密码"
                                                                               style="width: 160px"
                                                                               type="text"
                                                                               v-model="entity.mima"></td>
                                                                </tr>
                                                                <tr>
                                                                    <td>姓名</td>
                                                                    <td><input class="form-control" id="xingming"
                                                                               placeholder="请输入姓名"
                                                                               style="width: 160px"
                                                                               type="text"
                                                                               v-model="entity.xingming"></td>
                                                                </tr>
                                                                <tr>
                                                                    <td>性别</td>
                                                                    <td><select class="form-control"
                                                                                style="width: 200px;"
                                                                                v-model="entity.xingbie">
                                                                        <option value="男">男</option>
                                                                        <option value="女">女</option>
                                                                    </select></td>
                                                                </tr>
                                                                <tr>
                                                                    <td>出生日期</td>
                                                                    <td><input class="form-control" id="chushengriqi"
                                                                               placeholder="请输入出生日期"
                                                                               style="width: 160px"
                                                                               type="text"
                                                                               v-model="entity.chushengriqi">
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td>手机</td>
                                                                    <td><input class="form-control" id="shouji"
                                                                               placeholder="请输入手机"
                                                                               style="width: 160px"
                                                                               type="text"
                                                                               v-model="entity.shouji"></td>
                                                                </tr>
                                                                <tr>
                                                                    <td>身份证</td>
                                                                    <td><input class="form-control" id="shenfenzheng"
                                                                               placeholder="请输入身份证"
                                                                               style="width: 160px"
                                                                               type="text"
                                                                               v-model="entity.shenfenzheng"></td>
                                                                </tr>
                                                                <tr>
                                                                    <td>头像</td>
                                                                    <td>
                                                                        <el-upload :before-upload="touxiangbaul"
                                                                                   :on-success="touxiangsccs"
                                                                                   :show-file-list="false"
                                                                                   action="/files/upload"
                                                                                   class="avatar-uploader"><img
                                                                                :src="touxiangimrl" class="avatar"
                                                                                v-if="touxiangimrl"><img
                                                                                :src="'/files/download/'+touxiangavt"
                                                                                class="avatar"
                                                                                v-else-if="touxiangavt"> <i class="el-icon-plus avatar-uploader-icon"
                                                                                                   v-else></i>
                                                                        </el-upload>
                                                                    </td>
                                                                </tr>

                                                            </table>
                                                        </form>
                                                        <div style="text-align: center">
                                                            <button class="btn btn-primary" type="button"
                                                                    v-on:click="update()">保存
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- 表格主体结束-->
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <script src="sidebufen.js"></script>
        </div>
        <script src="qtdown.js"></script>
    </div>
    <script src="qtimages/js/jquery.magnific-popup.min.js" type="text/javascript"></script>
    <script src="qtimages/js/jquery.appear.js" type="text/javascript"></script>
    <script src="qtimages/js/jquery.imagesloaded.min.js" type="text/javascript"></script>
    <script src="qtimages/js/jquery.isotope.min.js" type="text/javascript"></script>
    <script src="qtimages/js/retina-1.1.0.min.js" type="text/javascript"></script>
    <script src="qtimages/js/plugins-scroll.js" type="text/javascript"></script>
    <script src="qtimages/js/waypoint.min.js" type="text/javascript"></script>
    <script src="qtimages/js/jquery.themepunch.tools.min.js" type="text/javascript"></script>
    <script src="qtimages/js/jquery.themepunch.revolution.min.js" type="text/javascript"></script>
    <script src="qtimages/js/script.js" type="text/javascript"></script>
    <link href="qtimages/css/jquery.mmenu.all.css" rel="stylesheet" type="text/css"/>
    <script src="qtimages/js/jquery.mmenu.all.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        jQuery(document).ready(function ($) {
            var mmenu = $('nav#mmenu').mmenu({
                slidingSubmenus: true,
                classes: 'mm-white',
                //mm-fullscreen mm-light
                extensions: ["theme-white"],
                offCanvas: {
                    position: "right",
                    //left, top, right, bottom
                    zposition: "front" //back, front,next
                    //modal		: true
                },
                searchfield: false,
                counters: false,
                //navbars		: {
                //content : [ "prev", "title", "next" ]
                //},
                navbar: {
                    title: "网站导航"
                },
                header: {
                    add: true,
                    update: true,
                    title: "网站导航"
                }
            });
            $(".closemenu").click(function () {
                var mmenuAPI = $("#mmenu").data("mmenu");
                mmenuAPI.close();
            });
        });
    </script>
    <!--daipxingxlun-->
</div>
<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/common.css" rel="stylesheet">
<link href="css/nav.css" rel="stylesheet">
<link href="css/font-awesome.css" rel="stylesheet">
<link href="css/element/index.css" rel="stylesheet">
<link href="css/hsg.css" rel="stylesheet">
<script src="js/my.js"></script>
<script src="js/vue2.6.11/vue.min.js"></script>
<script src="js/vue2.6.11/axios.js"></script>
<script src="js/element/index.js"></script>
<script>
    function checkValid(entity) {
        if (!entity.yonghuming || entity.yonghuming === "") {
            alert("用户名不能为空");
            return false;
        }
        if (!entity.xingming || entity.xingming === "") {
            alert("姓名不能为空");
            return false;
        }
        if (entity.shenfenzheng && entity.shenfenzheng !== "") {
            let reg = /^\d{15}$|^\d{18}$|^\d{17}[xX]$/;
            if (!reg.test(entity.shenfenzheng)) {
                alert("请输入正确的身份证");
                return false;
            }
        }

        return true;
    }

    new Vue({
        el: '#wrapper',
        data: {

            authority: [],
            permission: [],
            storeUser: JSON.parse(localStorage.getItem("user")),
            name: '',
            user: {},
            yonghuxinxiInfo: {},
            //hsgdanhejisuan
            touxiangimrl: '',
//youtupianimrl			
            objs: [],

            touxiangavt: null,
//youtupianavt			
            //youxia2sui
            //youxxiabiaoxduan
            entity: {
                touxiangflst: [],
//youtupianflst			
            }
        },
        created: function () {
            //this.loadData();

            axios.get('/auth').then(res => {
                if (res.data.code === '0') {
                    this.user = res.data.data;
                }
            });


            //this.user = JSON.parse(localStorage.getItem('user'));


        },
        methods: {

            //m_liangbuinit

            //liebiloadaoduqu
            //yofujifsuan2
            update() {
                if (checkValid(this.entity)) {

                    if (!this.entity.id) {
                        axios.post(
                            "/yonghuxinxiInfo", this.entity
                        ).then(res => {
                            if (res.data.code === '0') {
                                msg('success', '添加成功');
                                $('#mod').modal('hide');
                                this.loadTable(1);
                            } else {
                                msg('error', res.data.msg);
                            }
                        })
                    }
                }
            },
            getQueryVariable(variable) {
                let query = window.location.search.substring(1);
                let vars = query.split("&");
                for (let i = 0; i < vars.length; i++) {
                    let pair = vars[i].split("=");
                    if (pair[0] === variable) {
                        return pair[1];
                    }
                }
                return '';
            },
            touxiangsccs(res, file) {
                this.touxiangimrl = URL.createObjectURL(file.raw);
                this.entity.touxiangflst.push(res.data.id);
                this.touxiangavt = res.data.id
            },
            touxiangbaul(file) {
                this.entity.touxiangflst = [];
                const isJPG = file.type === 'image/jpeg';
                const isLt2M = file.size / 1024 / 1024 / 1024 < 2;

                if (!isJPG) {
                    this.$message.error('上传头像图片只能是 JPG 格式!');
                }
                if (!isLt2M) {
                    this.$message.error('上传头像图片大小不能超过 2000MB!');
                }
                return isJPG && isLt2M;
            },
            //m_tupiansccsbaul

            //youscwenjian

            //x2suilafuxzhi
            logout() {
                logout();
            }
        }
    })
</script>
</body>
</html>
